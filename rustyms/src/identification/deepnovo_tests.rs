#![allow(clippy::missing_panics_doc)]
use std::io::BufReader;

use crate::identification::DeepNovoData;

use super::IdentifiedPeptideSource;

use super::{csv::parse_csv_raw, deepnovo, IdentifiedPeptide};

#[test]
fn deepnovo() {
    let reader = BufReader::new(V0_0_1.as_bytes());
    let lines = parse_csv_raw(reader, b'\t', None).unwrap();
    let mut peptides = 0;
    for line in lines.map(Result::unwrap) {
        println!("{line}");
        let _read: IdentifiedPeptide = DeepNovoData::parse_specific(&line, &deepnovo::V0_0_1, None)
            .unwrap()
            .into();
        peptides += 1;
    }
    assert_eq!(peptides, 19);
}

const V0_0_1: &str = "scan	predicted_sequence	predicted_score	predicted_position_score
14	V,A,P,E,I,P,V,Y,I,N,E,V,A,I,V,I,I,P,A,I,A,A,R	-1.53	-2.72,-0.55,-1.77,-0.85,-1.36,-0.46,-1.95,-0.89,-2.23,-1.98,-0.38,-1.17,-2.06,-1.45,-1.43,-2.26,-1.98,-1.47,-2.14,-1.91,-2.26,-1.89
15	I,I,P,K,P,I,V,I,I,G,A,Nmod,G,T,T,V,I,V,G,M,P,A,G,A,K	-1.05	-3.45,-4.20,-2.48,-0.37,-3.40,-1.80,-1.82,-1.67,-0.16,-0.39,-1.86,-0.00,-0.01,-0.00,-0.00,-0.03,-0.12,-0.12,-0.31,-1.24,-0.55,-0.68,-0.45,-1.16
2535	E,E,E,T,H,I,K,P,S,N,T,K,V,D,K	-0.42	-0.96,-0.10,-2.23,-0.04,-0.31,-0.06,-0.00,-0.03,-0.32,-1.52,-0.09,-0.30,-0.30,-0.06
2536	N,F,P,I,N,P,P,P,E,N,S,I,Cmod,K,K	-0.78	-1.86,-0.29,-1.46,-1.12,-0.04,-0.61,-0.40,-0.56,-1.87,-0.79,-0.47,-1.51,-0.46,-0.07
2537	A,P,Q,S,G,S,V,S,S,D,D,T,Q,N,Q,H,E,N,Q,H,T,N,S,T,Y,R	-0.61	-0.55,-1.66,-0.75,-0.50,-1.33,-1.52,-0.94,-0.13,-0.59,-0.63,-0.04,-0.23,-0.93,-0.90,-0.00,-0.51,-0.24,-0.67,-0.58,-0.15,-1.00,-0.48,-0.32,-1.13,-0.14
2538	H,G,G,N,S,S,S,N,N,G,T,G,M,P,P,Q,D,A,G,G,G,V,G,S,A,F,Y,D,I,H	-0.55	-0.73,-0.69,-0.82,-0.11,-0.86,-0.73,-0.03,-0.21,-0.45,-1.39,-0.05,-0.01,-0.40,-1.24,-0.07,-1.46,-0.18,-0.42,-0.01,-0.00,-0.96,-0.22,-0.13,-0.52,-0.17,-0.41,-0.23,-1.93,-1.91
2539	H,I,D,Cmod,A,A,Q,D,Q,Y,T,Q,A,Q,Y,N,Q,H,T,N,S,T,Y,R	-0.57	-0.04,-2.49,-0.26,-0.66,-0.68,-0.08,-1.62,-0.64,-0.08,-0.96,-0.43,-1.19,-1.03,-0.05,-0.18,-0.63,-0.10,-0.04,-0.28,-0.07,-0.13,-1.84,-0.15
2540	S,G,S,D,Y,Y,Y,G,F,Y,A,G,P,V,S,P,Y,T,H,A,T,T,S,G,D,I,H	-0.76	-2.37,-0.13,-1.19,-0.87,-0.27,-0.23,-1.02,-0.15,-0.26,-0.41,-1.13,-0.92,-1.05,-0.65,-0.35,-0.56,-0.17,-0.07,-0.29,-0.71,-1.07,-0.71,-0.95,-1.30,-2.76,-0.83
2541	H,V,E,G,E,S,I,D,A,Y,D,S,S,S,S,S,T,P,S,R,P,A,S,S,S,N,M,G,K	-0.59	-0.56,-1.03,-0.07,-1.77,-0.68,-0.17,-0.68,-0.62,-0.01,-0.12,-0.43,-1.43,-1.30,-0.12,-0.20,-0.71,-0.92,-0.32,-0.40,-0.35,-0.11,-1.63,-0.05,-0.73,-0.81,-1.31,-0.28,-0.22
2542	H,S,G,S,S,S,S,T,S,S,N,S,S,S,S,S,N,T,V,Y,T,H,A,S,S,S,S,I,I,H	-0.65	-0.71,-1.20,-1.20,-0.85,-0.43,-0.27,-0.49,-0.11,-0.58,-0.35,-0.48,-1.00,-1.16,-0.30,-0.10,-0.19,-1.26,-0.03,-0.03,-0.07,-0.09,-0.15,-1.08,-0.19,-1.13,-1.28,-1.28,-1.91,-1.43
2546	D,N,M,Q,H,I,K,P,S,N,T,K,V,D,K	-0.55	-0.89,-2.42,-1.65,-0.47,-0.72,-0.03,-0.00,-0.07,-0.54,-0.69,-0.43,-0.18,-0.09,-0.08
2547	E,T,P,G,A,N,T,P,V,P,S,N,T,K,V,D,K	-0.65	-1.01,-0.38,-1.43,-0.46,-1.41,-1.73,-0.00,-0.40,-0.02,-0.07,-0.69,-1.44,-0.76,-0.31,-0.77,-0.08
2550	S,F,Y,H,I,K,G,E,I,T,K,V,D,K	-0.53	-0.58,-2.46,-0.26,-0.74,-2.08,-0.00,-0.04,-0.12,-0.85,-0.12,-0.14,-0.04,-0.00
2551	I,A,N,V,N,E,I,S,I,N,H,V,V,S,R	-0.57	-0.84,-0.10,-0.27,-0.24,-0.52,-0.52,-0.41,-0.30,-0.27,-1.09,-1.42,-0.12,-0.22,-2.20
2552	H,V,E,Cmod,P,A,A,I,Y,Cmod,P,S,Y,V,T,S,I,A,G,Y,G,S,S,Y,D	-0.67	-0.86,-0.81,-0.00,-0.54,-1.68,-0.50,-0.86,-0.41,-0.02,-0.11,-1.76,-0.18,-0.08,-0.01,-0.50,-0.83,-0.51,-0.05,-0.12,-0.07,-1.89,-1.09,-0.86,-3.08
2553	N,A,E,E,G,Q,F,D,G,T,D,P,E,A,W,T,T,V,A,G,Y,P,G,V,A,A,N	-0.70	-2.09,-0.01,-0.14,-0.26,-1.12,-0.44,-0.54,-0.25,-0.15,-1.36,-0.28,-0.79,-0.03,-0.05,-1.10,-0.85,-0.38,-0.91,-0.02,-0.33,-0.03,-2.22,-1.48,-0.32,-1.46,-2.26
2554	H,V,E,Cmod,P,A,A,I,Y,Cmod,G,A,G,P,Y,Y,T,Y,Y,S,E,S,W,G,K	-0.59	-0.95,-1.26,-0.01,-0.37,-1.77,-0.64,-1.03,-0.34,-0.02,-0.13,-0.80,-1.25,-1.40,-0.78,-0.03,-0.08,-0.56,-0.22,-0.25,-0.04,-0.53,-1.27,-0.96,-0.00
2559	I,S,H,V,S,S,G,G,G,A,S,E,V,I,I,V,G,A,D	-0.39	-0.03,-1.84,-0.93,-1.22,-0.48,-0.84,-0.00,-0.00,-0.01,-0.00,-0.00,-1.15,-0.40,-0.11,-0.00,-0.14,-0.14,-0.03
2560	I,I,G,G,I,M,T,Y,G,D,F,N,Q,T,P,K	-0.59	-0.26,-1.40,-1.23,-0.65,-0.37,-0.11,-0.04,-0.49,-0.22,-1.55,-0.72,-0.66,-0.97,-0.57,-0.27";
